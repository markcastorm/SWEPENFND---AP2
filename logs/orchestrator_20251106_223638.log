2025-11-06 22:36:38,182 - INFO - ================================================================================
2025-11-06 22:36:38,184 - INFO - AP2 Data Pipeline Orchestrator
2025-11-06 22:36:38,185 - INFO - Execution Time: 2025-11-06 22:36:38
2025-11-06 22:36:38,186 - INFO - ================================================================================
2025-11-06 22:36:38,188 - INFO - 
[STEP 1/2] Running Web Scraper...
2025-11-06 22:36:38,193 - INFO - ================================================================================
2025-11-06 22:36:38,217 - INFO - Starting: Web Scraper (Download PDFs)
2025-11-06 22:36:38,223 - INFO - ================================================================================
2025-11-06 22:37:32,251 - INFO - [ap2_scraper.py] ================================================================================
2025-11-06 22:37:32,251 - INFO - [ap2_scraper.py] AP2 Financial Reports Scraper
2025-11-06 22:37:32,251 - INFO - [ap2_scraper.py] ================================================================================
2025-11-06 22:37:32,252 - INFO - [ap2_scraper.py] Target year: latest
2025-11-06 22:37:32,252 - INFO - [ap2_scraper.py] Download directory: downloads\20251106_223640
2025-11-06 22:37:32,252 - INFO - [ap2_scraper.py] Website: https://ap2.se/en/news-and-reports/reports/financial-reports/
2025-11-06 22:37:32,252 - INFO - [ap2_scraper.py] 
2025-11-06 22:37:32,253 - INFO - [ap2_scraper.py] Setting up Chrome driver...
2025-11-06 22:37:32,253 - INFO - [ap2_scraper.py] OK Chrome driver ready
2025-11-06 22:37:32,253 - INFO - [ap2_scraper.py] 
2025-11-06 22:37:32,254 - INFO - [ap2_scraper.py] Navigating to https://ap2.se/en/news-and-reports/reports/financial-reports/...
2025-11-06 22:37:32,254 - INFO - [ap2_scraper.py] OK Accepted cookies
2025-11-06 22:37:32,254 - INFO - [ap2_scraper.py] OK Found 52 unique reports on page
2025-11-06 22:37:32,254 - INFO - [ap2_scraper.py] 
2025-11-06 22:37:32,255 - INFO - [ap2_scraper.py] 'latest' resolved to year: 2025
2025-11-06 22:37:32,255 - INFO - [ap2_scraper.py]   - Half-year Report 2025
2025-11-06 22:37:32,256 - INFO - [ap2_scraper.py] 
2025-11-06 22:37:32,256 - INFO - [ap2_scraper.py] OK Filtered to 1 reports to download
2025-11-06 22:37:32,256 - INFO - [ap2_scraper.py] 
2025-11-06 22:37:32,257 - INFO - [ap2_scraper.py] ================================================================================
2025-11-06 22:37:32,257 - INFO - [ap2_scraper.py] DOWNLOADING REPORTS
2025-11-06 22:37:32,258 - INFO - [ap2_scraper.py] ================================================================================
2025-11-06 22:37:32,260 - INFO - [ap2_scraper.py] 
2025-11-06 22:37:32,264 - INFO - [ap2_scraper.py] [1/1] Half-year Report 2025...
2025-11-06 22:37:32,264 - INFO - [ap2_scraper.py]   OK Downloaded: Half-year-Report-2025.pdf (2625.6 KB)
2025-11-06 22:37:32,266 - INFO - [ap2_scraper.py] 
2025-11-06 22:37:32,267 - INFO - [ap2_scraper.py] ================================================================================
2025-11-06 22:37:32,267 - INFO - [ap2_scraper.py] SCRAPER COMPLETED
2025-11-06 22:37:32,268 - INFO - [ap2_scraper.py] ================================================================================
2025-11-06 22:37:32,268 - INFO - [ap2_scraper.py] OK Downloaded 1 reports
2025-11-06 22:37:32,269 - INFO - [ap2_scraper.py] OK Location: downloads\20251106_223640
2025-11-06 22:37:32,270 - INFO - [ap2_scraper.py] ================================================================================
2025-11-06 22:37:32,270 - WARNING - [ap2_scraper.py] Exception ignored in: <function Chrome.__del__ at 0x0000029035B14B80>
2025-11-06 22:37:32,270 - WARNING - [ap2_scraper.py] Traceback (most recent call last):
2025-11-06 22:37:32,271 - WARNING - [ap2_scraper.py]   File "C:\Users\casto\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\undetected_chromedriver\__init__.py", line 843, in __del__
2025-11-06 22:37:32,272 - WARNING - [ap2_scraper.py]     self.quit()
2025-11-06 22:37:32,273 - WARNING - [ap2_scraper.py]   File "C:\Users\casto\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\undetected_chromedriver\__init__.py", line 798, in quit
2025-11-06 22:37:32,274 - WARNING - [ap2_scraper.py]     time.sleep(0.1)
2025-11-06 22:37:32,274 - WARNING - [ap2_scraper.py] OSError: [WinError 6] The handle is invalid
2025-11-06 22:37:32,274 - INFO - OK Web Scraper (Download PDFs) completed successfully
2025-11-06 22:37:32,276 - INFO - 
[STEP 2/2] Running PDF Parser...
2025-11-06 22:37:32,278 - INFO - ================================================================================
2025-11-06 22:37:32,283 - INFO - Starting: PDF Parser (Extract & Format)
2025-11-06 22:37:32,283 - INFO - ================================================================================
2025-11-06 22:37:35,388 - INFO - [pdf_parser.py] ================================================================================
2025-11-06 22:37:35,388 - INFO - [pdf_parser.py] AP2 PDF Parser
2025-11-06 22:37:35,389 - INFO - [pdf_parser.py] ================================================================================
2025-11-06 22:37:35,389 - INFO - [pdf_parser.py] Processing folder: downloads\20251106_223640
2025-11-06 22:37:35,390 - INFO - [pdf_parser.py] Found 1 PDF files
2025-11-06 22:37:35,390 - INFO - [pdf_parser.py] 
2025-11-06 22:37:35,390 - INFO - [pdf_parser.py] 
2025-11-06 22:37:35,391 - INFO - [pdf_parser.py] Extracting from: AP2_2025_half_year.pdf
2025-11-06 22:37:35,391 - INFO - [pdf_parser.py]   Found balance sheet on page 6
2025-11-06 22:37:35,391 - INFO - [pdf_parser.py]     - Listed equities: 184,676,178,237,181,952
2025-11-06 22:37:35,392 - INFO - [pdf_parser.py]     - Unlisted equities: 131,970,139,010,146,896
2025-11-06 22:37:35,392 - INFO - [pdf_parser.py]     - Bonds: 246,921,714,723
2025-11-06 22:37:35,392 - INFO - [pdf_parser.py]     - Listed equities: 88,081,369,618,491
2025-11-06 22:37:35,393 - INFO - [pdf_parser.py]     - Unlisted equities: 131,240,636,074
2025-11-06 22:37:35,393 - INFO - [pdf_parser.py]     - Bonds: 263,623,732,495
2025-11-06 22:37:35,394 - INFO - [pdf_parser.py]     - Total assets: 464,970,450,002,468,736
2025-11-06 22:37:35,397 - INFO - [pdf_parser.py]     - Derivative instruments (liabilities): 254,213,438,913
2025-11-06 22:37:35,399 - INFO - [pdf_parser.py]     - Total liabilities: 692,141,809,852
2025-11-06 22:37:35,399 - INFO - [pdf_parser.py]     - Net result for period: 15,752,064,834,868
2025-11-06 22:37:35,401 - INFO - [pdf_parser.py]     - Fund capital carried forward: 458,884,426,040,426,048
2025-11-06 22:37:35,401 - INFO - [pdf_parser.py]     - Net payments to pension system: -2,410
2025-11-06 22:37:35,402 - INFO - [pdf_parser.py]     - Net result for period: 15,752,064,834,868
2025-11-06 22:37:35,402 - INFO - [pdf_parser.py]     - Total fund capital: 458,049,445,822,458,880
2025-11-06 22:37:35,403 - INFO - [pdf_parser.py]   OK Extracted 10 fields
2025-11-06 22:37:35,403 - INFO - [pdf_parser.py] 
2025-11-06 22:37:35,403 - INFO - [pdf_parser.py] ================================================================================
2025-11-06 22:37:35,404 - INFO - [pdf_parser.py] CREATING OUTPUT
2025-11-06 22:37:35,406 - INFO - [pdf_parser.py] ================================================================================
2025-11-06 22:37:35,407 - INFO - [pdf_parser.py] OK Saved: output\20251106_223734\AP2_Financial_Data_20251106_223734.xlsx
2025-11-06 22:37:35,407 - INFO - [pdf_parser.py] OK Saved: output\latest\AP2_Financial_Data_latest.xlsx
2025-11-06 22:37:35,408 - INFO - [pdf_parser.py] OK Filled 12/20 data cells (60.0%)
2025-11-06 22:37:35,409 - INFO - [pdf_parser.py] 
2025-11-06 22:37:35,409 - INFO - [pdf_parser.py] ================================================================================
2025-11-06 22:37:35,410 - INFO - [pdf_parser.py] PARSER COMPLETED
2025-11-06 22:37:35,410 - INFO - [pdf_parser.py] ================================================================================
2025-11-06 22:37:35,411 - INFO - [pdf_parser.py] OK Processed 1 PDFs
2025-11-06 22:37:35,411 - INFO - [pdf_parser.py] OK Extracted data for 1 years
2025-11-06 22:37:35,412 - INFO - [pdf_parser.py] OK Output: output\20251106_223734\AP2_Financial_Data_20251106_223734.xlsx
2025-11-06 22:37:35,413 - INFO - [pdf_parser.py] ================================================================================
2025-11-06 22:37:35,413 - INFO - OK PDF Parser (Extract & Format) completed successfully
2025-11-06 22:37:35,414 - INFO - 
================================================================================
2025-11-06 22:37:35,416 - INFO - OK PIPELINE COMPLETED SUCCESSFULLY
2025-11-06 22:37:35,416 - INFO - ================================================================================
2025-11-06 22:37:35,417 - INFO - Total execution time: 57.23 seconds (0.95 minutes)
2025-11-06 22:37:35,420 - INFO - Output file: output/latest/AP2_Financial_Data_latest.xlsx
2025-11-06 22:37:35,421 - INFO - ================================================================================
