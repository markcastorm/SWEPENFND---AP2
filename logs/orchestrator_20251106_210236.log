2025-11-06 21:02:36,396 - INFO - ================================================================================
2025-11-06 21:02:36,396 - INFO - AP2 Data Pipeline Orchestrator
2025-11-06 21:02:36,396 - INFO - Execution Time: 2025-11-06 21:02:36
2025-11-06 21:02:36,397 - INFO - ================================================================================
2025-11-06 21:02:36,397 - INFO - 
[STEP 1/2] Running Web Scraper...
2025-11-06 21:02:36,397 - INFO - ================================================================================
2025-11-06 21:02:36,398 - INFO - Starting: Web Scraper (Download PDFs)
2025-11-06 21:02:36,399 - INFO - ================================================================================
2025-11-06 21:03:14,375 - INFO - [ap2_scraper.py] ================================================================================
2025-11-06 21:03:14,376 - INFO - [ap2_scraper.py] AP2 Financial Reports Scraper
2025-11-06 21:03:14,376 - INFO - [ap2_scraper.py] ================================================================================
2025-11-06 21:03:14,376 - INFO - [ap2_scraper.py] Target year: latest
2025-11-06 21:03:14,376 - INFO - [ap2_scraper.py] Download directory: downloads\20251106_210237
2025-11-06 21:03:14,377 - INFO - [ap2_scraper.py] Website: https://ap2.se/en/news-and-reports/reports/financial-reports/
2025-11-06 21:03:14,377 - INFO - [ap2_scraper.py] 
2025-11-06 21:03:14,377 - INFO - [ap2_scraper.py] Setting up Chrome driver...
2025-11-06 21:03:14,377 - INFO - [ap2_scraper.py] OK Chrome driver ready
2025-11-06 21:03:14,378 - INFO - [ap2_scraper.py] 
2025-11-06 21:03:14,378 - INFO - [ap2_scraper.py] Navigating to https://ap2.se/en/news-and-reports/reports/financial-reports/...
2025-11-06 21:03:14,378 - INFO - [ap2_scraper.py] OK Accepted cookies
2025-11-06 21:03:14,378 - INFO - [ap2_scraper.py] OK Found 52 unique reports on page
2025-11-06 21:03:14,379 - INFO - [ap2_scraper.py] 
2025-11-06 21:03:14,379 - INFO - [ap2_scraper.py] 'latest' resolved to year: 2025
2025-11-06 21:03:14,379 - INFO - [ap2_scraper.py]   - Half-year Report 2025
2025-11-06 21:03:14,379 - INFO - [ap2_scraper.py] 
2025-11-06 21:03:14,380 - INFO - [ap2_scraper.py] OK Filtered to 1 reports to download
2025-11-06 21:03:14,380 - INFO - [ap2_scraper.py] 
2025-11-06 21:03:14,380 - INFO - [ap2_scraper.py] ================================================================================
2025-11-06 21:03:14,381 - INFO - [ap2_scraper.py] DOWNLOADING REPORTS
2025-11-06 21:03:14,382 - INFO - [ap2_scraper.py] ================================================================================
2025-11-06 21:03:14,382 - INFO - [ap2_scraper.py] 
2025-11-06 21:03:14,383 - INFO - [ap2_scraper.py] [1/1] Half-year Report 2025...
2025-11-06 21:03:14,383 - INFO - [ap2_scraper.py]   OK Downloaded: Half-year-Report-2025.pdf (2625.6 KB)
2025-11-06 21:03:14,384 - INFO - [ap2_scraper.py] 
2025-11-06 21:03:14,385 - INFO - [ap2_scraper.py] ================================================================================
2025-11-06 21:03:14,385 - INFO - [ap2_scraper.py] SCRAPER COMPLETED
2025-11-06 21:03:14,386 - INFO - [ap2_scraper.py] ================================================================================
2025-11-06 21:03:14,386 - INFO - [ap2_scraper.py] OK Downloaded 1 reports
2025-11-06 21:03:14,387 - INFO - [ap2_scraper.py] OK Location: downloads\20251106_210237
2025-11-06 21:03:14,387 - INFO - [ap2_scraper.py] ================================================================================
2025-11-06 21:03:14,387 - WARNING - [ap2_scraper.py] Exception ignored in: <function Chrome.__del__ at 0x0000027AE7714B80>
2025-11-06 21:03:14,387 - WARNING - [ap2_scraper.py] Traceback (most recent call last):
2025-11-06 21:03:14,388 - WARNING - [ap2_scraper.py]   File "C:\Users\casto\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\undetected_chromedriver\__init__.py", line 843, in __del__
2025-11-06 21:03:14,388 - WARNING - [ap2_scraper.py]     self.quit()
2025-11-06 21:03:14,389 - WARNING - [ap2_scraper.py]   File "C:\Users\casto\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\undetected_chromedriver\__init__.py", line 798, in quit
2025-11-06 21:03:14,389 - WARNING - [ap2_scraper.py]     time.sleep(0.1)
2025-11-06 21:03:14,389 - WARNING - [ap2_scraper.py] OSError: [WinError 6] The handle is invalid
2025-11-06 21:03:14,390 - INFO - OK Web Scraper (Download PDFs) completed successfully
2025-11-06 21:03:14,390 - INFO - 
[STEP 2/2] Running PDF Parser...
2025-11-06 21:03:14,390 - INFO - ================================================================================
2025-11-06 21:03:14,391 - INFO - Starting: PDF Parser (Extract & Format)
2025-11-06 21:03:14,391 - INFO - ================================================================================
2025-11-06 21:03:16,574 - INFO - [pdf_parser.py] ================================================================================
2025-11-06 21:03:16,574 - INFO - [pdf_parser.py] AP2 PDF Parser
2025-11-06 21:03:16,575 - INFO - [pdf_parser.py] ================================================================================
2025-11-06 21:03:16,575 - INFO - [pdf_parser.py] Processing folder: downloads\20251106_210237
2025-11-06 21:03:16,575 - INFO - [pdf_parser.py] Found 1 PDF files
2025-11-06 21:03:16,575 - INFO - [pdf_parser.py] 
2025-11-06 21:03:16,576 - INFO - [pdf_parser.py] 
2025-11-06 21:03:16,576 - INFO - [pdf_parser.py] Extracting from: AP2_2025_half_year.pdf
2025-11-06 21:03:16,576 - INFO - [pdf_parser.py]   OK Extracted 5 tables
2025-11-06 21:03:16,576 - INFO - [pdf_parser.py]   Parsing financial data for year 2025...
2025-11-06 21:03:16,577 - INFO - [pdf_parser.py] 
2025-11-06 21:03:16,577 - INFO - [pdf_parser.py] WARNING: No financial data extracted
2025-11-06 21:03:16,577 - INFO - [pdf_parser.py] PDFs may have different structure than expected
2025-11-06 21:03:16,577 - INFO - OK PDF Parser (Extract & Format) completed successfully
2025-11-06 21:03:16,577 - INFO - 
================================================================================
2025-11-06 21:03:16,578 - INFO - OK PIPELINE COMPLETED SUCCESSFULLY
2025-11-06 21:03:16,578 - INFO - ================================================================================
2025-11-06 21:03:16,578 - INFO - Total execution time: 40.18 seconds (0.67 minutes)
2025-11-06 21:03:16,579 - INFO - Output file: output/latest/AP2_Financial_Data_latest.xlsx
2025-11-06 21:03:16,579 - INFO - ================================================================================
